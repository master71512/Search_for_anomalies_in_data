
### **Описание датасета**

| Сolumn         | Description                                                                                                          |
| -------------- | -------------------------------------------------------------------------------------------------------------------- |
| Date           | Date of Transaction                                                                                                  |
| nameOrig       | User Name or Account number                                                                                          |
| amount         | Money in this transaction                                                                                            |
| oldbalanceOrg  | How much the client had money before transaction                                                                     |
| newbalanceOrig | How much the client have after the transaction                                                                       |
| City           | where the transaction happened which city                                                                            |
| type           | Type of transaction TRANSFER \ CASH_OUT, CASH_IN ,DEBIT,PAYMENT                                                      |
| Card Type      | The card type the client has \ Platinum ,Gold ,Silver ,Signature ,Classic ,Mass                                      |
| Exp Type       | The purpose for transaction \ Food, Entertainment, Fuel, Bills, Grocery, Travel, Personal_Care, Health_Fitness, Home |
| Gender         | Male or Female                                                                                                       |
| isFraud        | 0 = no fraud, 1 = fraud                                                                                              |
### **Состав и объём датасета**

**1 048 574** строк, **11** столбцов
Транзакции производились в период с 2012 по 2014 годы
Всего операций в датасете 1048574. Пользователей банка 1048316
Признаки:
- `type`: **5** типов операций
- `Card Type`: **6** значений
- `Exp Type`: **9** значений (топ — _Food_, 220 115)
- `Gender`: **2** значения (топ — `F`, 551 182)
- `City`: **986** городов (топ — **Bengaluru, India**, 143 733; высокая концентрация по нескольким городам)
Пропуски, дубликаты в данных отсутствуют


**Круговая диаграмма количества совершенных операций по типам транзакций**
![[Pasted image 20251102112514.png]]

Проверка данных на наличие ошибок показала, что в данных отсутствуют аномалии вроде отрицательных сумм перевод, третьего класса для бинарного признака и прочего. Предварительно выдвигалась гипотеза, что в данных могут быть ошибки в виде несоответствия между old и new балансами, но `oldbalanceOrg - newbalanceOrig = amount`

*При кодировании признаков передо обучением моделей фичи `type`, `Card Type`, `Exp Type`, `Gender` можно кодировать с помощью OneHotEncoder, а для `City` выбрать другой кодировщик, не one-hot*

Проверено количество распределений по временному промежутку с 2012 по 2014 годы
![[Pasted image 20251102112946.png]]
![[Pasted image 20251102112952.png]]

В июне-июле 2014 года наблюдается резкий спад количества совершаемых операций
Гипотезы происхождения аномалии:
- отток клиентов
- уход в чёрную
- ошибки в сборке датасета

При обучении нельзя делать случайное разбиение на train и test. нужно будет либо добавлять столбец обозначающий нулём период до июня-июля 2014, и единицей после. Либо можно деление данных строить совсем случайно

При изучении поведения каждого признака в отдельности было выявлено что `LabelEncoder` присваивает категориям **произвольные** номера. Любая «корреляция» таких кодов с `isFraud` приведёт к ложной интерпретации (числа не отражают ни порядка, ни расстояний).

Перед обучением модели необходимо будет отдельными шагами не опираемся на корреляции с `*_encoded`. Вместо этого считаем Спирмана для чисел и Пирсона с коэффициентом V Крамера для категорий
![[Pasted image 20251102140757.png]]

На графиках попарной зависимости не отображается квадратичной или иной зависимости. Можно только заметить, что мошеннических операций больше среди счетов с более низким балансом, а также среди операций на более высокие суммы. Подтверждается сказанное, что `LabelEncoder` не стоит брать в текущем виде, ибо появляется фиктивный порядок, видны столбы из вертикальных линий, которые не дают информации, а также не демонстрируют достоверных корреляций с целевым признаком 


![[Pasted image 20251102141917.png]]
![[Pasted image 20251102141921.png]]
![[Pasted image 20251102141925.png]]

Ввиду правоскошенности, длинных хвостов, надо будет пользоваться лог-преобразованиями для `amount`, `oldbalanceOrg` и `newbalanceOrg` чтобы обеспечить стабильность моделей
Так же резонно будет провести проверки уже для каждого типа операции в отдельности
В newbalanceOrig много значений нулевых или очень близких у нулевым => есть необходимость перепроверить датасет на наличие не нулей, а почти нулей, и уже с этим провести доп анализ



![[Pasted image 20251102151303.png]]

Выявлено, что во всех группах среднее значение больше медианного, а по IQR больше всего аномальных операций среди TRANSFER и CASH_OUT. CASH_IN тож подозрительный из-за крупных сумм, но разброс большой и доля выбросов из-за этого срезается

Проведено исследование профилей по типам операций
![[Pasted image 20251102151930.png]]

![[Pasted image 20251102151654.png]]
Профиль типов операций по городам почти одинаковый, явной географии по типам операции почти нет. Топ городов по доле фрода в целом совпадает с топов городов по числу населения, поэтому без инсайтов

Исследование Географии операций и их частоты и их частоты (все операции производились в Индии) продемонстрировало распределения транзакций по городам
![[Pasted image 20251102152133.png]]

> 4 крупнейших сегмента (вместе ~76%):
*   Бенгалуру
*   Дели
*   Ахмедабад
*   Мумбаи

> Остальные 6 городов (суммарно ~24%)
*   Хайдарабад
*   Ченнаи
*   Колката
*   Канпур
*   Лакхнау
*   Джайпур

#### **Итоги по EDA**

- Есть **структурный разрыв** в конце июня-июля 2014. Объём операций падает с ~1000 в день день до ~50. Предположительно анализ/валидацию лучше проводить с time-split. Или добавляем признак `period` (pre/post)
- Все числовые фичи сильно правоскошные, много нулей/почти нулей
- По типам операций CASH_IN самые крупные медианные суммы, а выбросов больше всего  (по IQR) в TRANSFER и CASH_OUT
- География. Профиль типов по городам почти одинаков, т.е. это слабый признак сам по себе. Возможно его резонно вообще удалить из датасета перед обучением и не усложнять себе задачу с кодировкой
- **LabelEncoder-коды** для категорий не годятся ни для корреляций, ни как признаки
- Ввиду правоскошенности, длинных хвостов, надо будет пользоваться лог-преобразованиями